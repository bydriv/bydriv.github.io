<!DOCTYPE html>

<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="/etc/site/style.css">
  <title>bydriv.github.io</title>
  <meta property="og:url" content="https://bydriv.github.io/blog/2021-01-01/" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="bydriv.github.io" />
  <meta property="og:description" content="純粋関数型グラフ - あるいはマンハッタン距離順序" />
  <meta property="og:site_name" content="bydriv.github.io" />
  <meta property="og:image" content="https://bydriv.github.io/etc/site/thumbnail.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <script type="text/javascript" src="/etc/site/kt.js"></script>
</head>

<div class="navigation"><!--
--><div class="left"><!--
--><a class="section" href="/">&#x221A;</a><!--
--><a class="section" href="/blog">&#x1F4DD;</a><!--
--><a class="section" href="/illustration">&#x1F3A8;</a><!--
--><a class="section" href="/photo">&#x1F4F7;</a><!--
--><a class="section" href="/literature">&#x1F516;</a><!--
--><a class="section" href="/world">&#x1F4BD;</a><!--
--><a class="section" href="/comic">&#x1F4AD;</a><!--
--><a class="section" href="/vr">&#x1F9E9;</a><!--
--><a class="section" href="/misc">&#x1F4C1;</a><!--
--></div>&nbsp;<!--
--><div class="right"><!--
--><a class="holoio section" href="#holoio">&#x22EF;</a><!--
--></div><!--
--></div><!--
--><div id="holoio">
<div class="navigation"><!--
--><div class="left"><!--
-->&nbsp;</div>&nbsp;<!--
--><div class="right"><!--
--><a class="section" href="#">&#x2573;</a><!--
--></div><!--
--></div>

<div class="kt-month-calendar" data-today="true"></div>
</div>

<article>
<h1 id="純粋関数型グラフ---あるいはマンハッタン距離順序">純粋関数型グラフ - あるいはマンハッタン距離順序</h1>
<ul>
<li><em><a href="../2020-12-12">プログラミング言語に標準で単射がほしいという話</a> の続き (？)</em></li>
</ul>
<p>あけましておめでとうございます。去年からグラフや順序についていろいろと試行錯誤していたらいつの間にか年が明けてしまいました。 1 年の計はなんとやら。なにごとも出だしが重要というわけです（ほんまか）。以前からグラフを扱うデータ構造に興味があっていろいろと考えていたのだけど、どう頑張っても木の回転をうまく定義できず固定長のデータ構造として考えるのであればよいのですが、動的に長さを変える用途に向いておらずデータ構造ではなく順序関係を最適化する方向に舵を切りマンハッタン距離の 45 度回転に辿りつきました。それを最近かなりうまく定義できた気がするので記事にしてみます。</p>
<h2 id="動機と直観">動機と直観</h2>
<p>まず最初に左から右も、右から左もひくことができるデータ構造がほしいという動機がある。つまり <code>(Map a b, Map b a)</code> 相当の操作が可能なデータ構造である。</p>
<p>直観としてそのようなデータ構造は数学的には <strong>二項関係</strong> そのものである。二項関係とは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> の直積集合の部分集合 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>⊆</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">G\subseteq{}A\times{}B</annotation></semantics></math> の組であり、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>G</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">R=(A,B,G)</annotation></semantics></math> と表される。ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math> は <strong>グラフ</strong> と呼ばれ、グラフと二項関係の違いは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> という <strong>始集合</strong> (<em>domain</em>) や <strong>終集合</strong> (<em>codomain</em>) について考えるかどうかである。たとえば写像 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi>A</mi><mo accent="false">→</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">f:A\rightarrow{}B</annotation></semantics></math> は二項関係の特別な場合であり、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x)=y</annotation></semantics></math> となるような <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math> をすべて集めた <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>y</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">G=\{(x,y)\in{}A\times{}B|f(x)=y\}</annotation></semantics></math> のようなグラフと考えることができる。ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> を考えることで部分写像という概念を考えることができるようになる。</p>
<p>さて問題は高々可算の集合 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> およびそれらの直積集合の部分集合 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>⊆</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">G\subseteq{}A\times{}B</annotation></semantics></math> からいかに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow></mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">x\in{}A</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">y\in{}B</annotation></semantics></math> を効率的に探索できるかという計算複雑性の問題に帰着できる。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> が全順序集合だとすれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow></mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">x\in{}A</annotation></semantics></math> を <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(log_2(n))</annotation></semantics></math> で探索できるのだから、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">A\times{}B</annotation></semantics></math> が全順序集合となる場合を考えることは自然な発想である。問題は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">A\times{}B</annotation></semantics></math> の全順序を定義するとき、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow></mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">x\in{}A</annotation></semantics></math> の順序や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">y\in{}B</annotation></semantics></math> の順序だけで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">(x,y)\in{}A\times{}B</annotation></semantics></math> の順序をある程度決定できる必要がある。辞書順は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow></mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">x\in{}A</annotation></semantics></math> のみで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">(x,y)\in{}A\times{}B</annotation></semantics></math> の順序をほとんど決定できるが、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">y\in{}B</annotation></semantics></math> の順序から探索することは困難である。</p>
<p>そのためのもっとも素朴な方法は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> が等しいものの同値類で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">A\times{}B</annotation></semantics></math> を割ってその同値類ごとに二分探索することが考えられる。これは <code>Map a (Set b)</code> そのものだが、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> の数をそれぞれ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> とすれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> の探索は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(log_2(n)+log_2(m)) = O(log_2(nm))</annotation></semantics></math> で済む (関係の数の対数オーダー) 一方で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> の探索は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(n log_2(m))</annotation></semantics></math> となる。これは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> がとても小さな値の場合には問題にならないものの一対一のような関係の場合、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n=m</annotation></semantics></math> となって <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> の探索は準線型オーダーとなるから、あまりよくない。そうなると <code>(Map a (Set b), Map b (Set a))</code> とすればよいとなりこれは穏当な構造であるものの、基本的に <code>Map</code> や <code>Set</code> というのは左から右をひいたりある要素があるかないかを判定するために特化したデータ構造であり、一対一の関係や多対多の関係を扱う場合、もっと最適な構造を考えることができるかもしれない。たとえば今回は左から右、右から左をひくときに常に 1 要素で探索することを前提としているものの、複数の要素が同時に属する関係を探索するなど、グラフを扱う場合はより複雑なことをする必要がある場合も多い。</p>
<p>さて大小関係を数直線として考えると、 1 要素の場合大小関係が単純な直線であるのに対して</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo><mo>,</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots, x_{-2}, x_{-1}, x_0, x_1, x_2, \cdots</annotation></semantics></math></p>
<p>2 要素の場合 2 次元の表になることがわかる。</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_{-2})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_{-2})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_{-2})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_{-2})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_{-2})</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_{-1})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_{-1})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_{-1})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_{-1})</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_{-1})</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_0)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_0)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_0)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_0)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_0)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_1)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_1)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_1)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_1)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_2)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_2)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_2)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_2)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_2)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>ここでこのような表がつくれるという根拠は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> が <strong>高々可算</strong> であることに依拠している。つまり自然数や整数で番号を振って離散的に並べることができるということである。非可算集合の場合、このような表をつくることがそもそもできない。</p>
<p>直積の順序はいくつか異なる定義が考えられる。プログラミング言語で一般的な順序は辞書順で、これは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> 軸の順序を優先した順序である。ほかの定義として <strong>積順序</strong> というものがありこれは</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo accent="false">⇔</mo><mrow></mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>x</mi><mo>′</mo><mo>∧</mo><mrow></mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>y</mi><mo>′</mo></mrow><annotation encoding="application/x-tex">(x,y)\leq(x&#39;,y&#39;)\Leftrightarrow{}x\leq{}x&#39;\land{}y\leq{}y&#39;</annotation></semantics></math></p>
<p>で定義される大小関係である。積順序の性質として、他方の順序のみで全体の順序を決定できるというものがある。つまりもし仮にすべての要素が積順序で並んでいたとすれば、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> だけでも <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> だけでも二分探索が可能である。その一方で積順序では比較不能なものは無数にある。つまり積順序は全順序にはならず、半順序になる。とはいえ積順序は左から右も、右から左もひくためのデータ構造に理想的な性質を持っている。</p>
<p>さて、そこで積順序で比較可能なものと比較不能なものについて考えよう。ここでは表の対角線に着目する。つまり、先の表においてまず</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_{-2})</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_{-1})</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_0)</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_2)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>という対角線にについて考えると、これは明らかにすべて積順序で比較可能であることがわかる。一方</p>
<table>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_{-2})</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_{-1})</annotation></semantics></math></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0, y_0)</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-1}, y_1)</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mrow><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_{-2}, y_2)</annotation></semantics></math></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>という対角線について考えると、これはすべて積順序で比較不能である。</p>
<p>そこでこの表を 45 度回転させることで積順序を自然に線型順序拡大した全順序が得られる。このような表を 45 度回転させるために好都合な道具があり、 <strong>マンハッタン距離</strong> と呼ばれる。</p>
<h2 id="距離順序と距離空間">距離順序と距離空間</h2>
<p>もし <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mrow></mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">x\in{}A</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">y\in{}B</annotation></semantics></math> をその順序関係で並べた数直線上の整数と同一視できるのであれば、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>∈</mo><mrow></mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">(x,y)\in{}G</annotation></semantics></math> の要素はそれらの線分の直交座標系の点と捉えることができる。そのためには通常の順序関係では力不足である。なぜなら通常の順序関係はふたつの要素がある数直線上においてより左側にあるかより右側にあるかまではわかるものの、それらのあいだの距離はわからないからである。ベクトル空間で考えるのもよさそうだが、順序を考える場合には、 2 次元や 3 次元の広がりをもつ空間よりは単なる直線であるほうが都合がよい。全順序は <strong>線型順序</strong> とも言いこれは全順序であるものを並べると直線になるからだ。そこで順序の距離というものを考えたい。</p>
<p>整数の距離は明らかであり、</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">d(i,j)=|i-j|</annotation></semantics></math></p>
<p>と定義できる。またこの距離は</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi><mo accent="false">⇔</mo><mrow></mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i=j\Leftrightarrow{}d(i,j)=0</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(i,j)=d(j,i)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(i,j)+d(j,k)\geq{}d(i,k)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">d(i,j)\geq{}0</annotation></semantics></math></li>
</ul>
<p>となるから、 <strong>距離空間</strong> (<em>metric space</em>) の公理を満たす。</p>
<p>またさらに強い性質</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(i,j)+d(j,k)=d(i,k)</annotation></semantics></math></li>
</ul>
<p>も満たすこともわかる。</p>
<p>全順序であり距離空間であるならば、その <strong>向き</strong> を考えることができる。つまり</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo accent="false">⇔</mo><mi>i</mi><mo>≥</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">f(i,j) = d(i,j) \Leftrightarrow i \geq j</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo accent="false">⇔</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">f(i,j) = -d(i,j) \Leftrightarrow i &lt; j</annotation></semantics></math></li>
</ul>
<p>と定義すればよい。順序を向き <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(i,j)</annotation></semantics></math> を大きさとするならば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(i,j)</annotation></semantics></math> は 1 次元のベクトルそのものである。</p>
<p>そこで距離空間の公理を負の数を許容するように変えた公理系を考えることができる。</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=y\Leftrightarrow{}f(x,y)=0</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)=-f(y,x)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(x,y)|+|f(y,z)|\geq{}|f(x,z)|</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\geq{}0\land{}f(y,z)\geq{}0\Rightarrow{}f(x,z)\geq{}0</annotation></semantics></math></li>
</ul>
<p>これらの公理からただちに</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\geq{}0\land{}f(y,z)\geq{}0\Rightarrow{}f(x,y)+f(y,z)\geq{}f(x,z)\geq{}0</annotation></semantics></math></li>
</ul>
<p>が証明できる。なんとなれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\geq{}0\land{}f(y,z)\geq{}0</annotation></semantics></math> であれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,z)\geq{}0</annotation></semantics></math> であり、 0 以上ならば絶対値の記号を外すことができるため</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)+f(y,z)\geq{}f(x,z)</annotation></semantics></math></li>
</ul>
<p>が出るからである。そしてこの定理からさらに</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\leq{}0\land{}f(y,z)\leq{}0\Rightarrow{}f(x,y)+f(y,z)\leq{}f(x,z)\leq{}0</annotation></semantics></math></li>
</ul>
<p>が証明できる。これは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)=-f(y,x)</annotation></semantics></math> は常に等しいから、符号を反転させれば常に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\geq{}0\land{}f(y,z)\geq{}0\Rightarrow{}f(x,y)+f(y,z)\geq{}f(x,z)\geq{}0</annotation></semantics></math> の関係に帰着させることができることによる。従って</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\leq{}0\land{}f(y,z)\leq{}0\Rightarrow{}f(x,z)\leq{}0</annotation></semantics></math></li>
</ul>
<p>である。</p>
<p>ここで</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x\leq{}y\Leftrightarrow{}f(x,y)\leq{}0</annotation></semantics></math></li>
</ul>
<p>と定義することで全順序となるし、また</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">d(x,y)=|f(x,y)|</annotation></semantics></math></li>
</ul>
<p>とすることで距離空間となることもわかる。よってこれを <strong>距離順序</strong> (<em>metric order</em>) と呼んで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> を <strong>距離順序関数</strong> と呼び、今後はこれを公理と考えて進めよう。</p>
<p><em>ただしこれは解釈の問題ではあるものの、順序を考えずに単なる距離に向きがある距離空間であると解釈したほうがすっきりする。言うなれば相対距離空間であろうか。当初の動機は順序の距離を考えることであったのでこの記事では距離順序と呼んでいるものの、いろいろと考えるうちにもうすこし一般化して相対距離空間と呼んだほうが妥当な気がする。</em></p>
<p>さて距離順序の公理は明らかに距離空間の公理よりも強いので、距離空間の公理は満たす。つまり</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=y\Leftrightarrow{}d(x,y)=0</annotation></semantics></math> (距離順序の公理より)</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(x,y)=d(y,x)</annotation></semantics></math> (絶対値をとっているので明らか)</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">d(x,y)+d(x,z)\geq{}d(x,z)</annotation></semantics></math> (距離順序の公理より)</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">d(x,y)\geq{}0</annotation></semantics></math> (絶対値をとっているので明らか)</li>
</ul>
<p>一方でこれが全順序になることはそこまで自明でもなくきちんと証明しておこう。</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">x\leq{}y</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">y\leq{}x</annotation></semantics></math> ならば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x=y</annotation></semantics></math></p>
<p><strong>証明</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x\leq{}y\Leftrightarrow{}f(x,y)\leq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>x</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y\leq{}x\Leftrightarrow{}f(y,x)\leq{}0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(y,x)=-f(x,y)</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\leq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">-f(x,y)\leq{}0</annotation></semantics></math> である。ゆえに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn><mo accent="false">⇔</mo><mrow></mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x,y)=0\Leftrightarrow{}x=y</annotation></semantics></math> ∎</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">x\leq{}y</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">y\leq{}z</annotation></semantics></math> ならば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">x\leq{}z</annotation></semantics></math></p>
<p><strong>証明</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x\leq{}y\Leftrightarrow{}f(x,y)\leq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>z</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y\leq{}z\Leftrightarrow{}f(y,z)\leq{}0</annotation></semantics></math> である。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)=-f(y,x)</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(y,z)=-f(z,y)</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(y,x)\geq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(z,y)\geq{}0</annotation></semantics></math> である。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(z,y)\geq{}0\land{}f(y,x)\geq{}0\Rightarrow{}f(z,x)\geq{}0</annotation></semantics></math> である。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(z,x)=-f(x,z)</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,z)\leq{}0</annotation></semantics></math> である。ゆえに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo accent="false">⇔</mo><mrow></mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">f(x,z)\leq{}0\Leftrightarrow{}x\leq{}z</annotation></semantics></math> ∎</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">x\leq{}y</annotation></semantics></math> または <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">y\leq{}x</annotation></semantics></math></p>
<p><strong>証明</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x\leq{}y\Leftrightarrow{}f(x,y)\leq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>x</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y\leq{}x\Leftrightarrow{}f(y,x)\leq{}0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(y,x)=-f(x,y)</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo accent="false">⇔</mo><mrow></mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x,y)\leq{}0\Leftrightarrow{}x\leq{}y</annotation></semantics></math> または <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mn>0</mn><mo accent="false">⇔</mo><mrow></mrow><mi>y</mi><mo>≤</mo><mrow></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">-f(x,y)\leq{}0\Leftrightarrow{}y\leq{}x</annotation></semantics></math> ∎</p>
<p>さて整数の差は自明な距離順序となる。つまり</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>i</mi><mo>−</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">f(i,j)=i-j</annotation></semantics></math></p>
<p>と置くと、これは</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=y\Leftrightarrow{}f(x,y)=0</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)=-f(y,x)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(x,y)|+|f(y,z)|\geq{}|f(x,z)|</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y)\geq{}0\land{}f(y,z)\geq{}0\Rightarrow{}f(x,z)\geq{}0</annotation></semantics></math></li>
</ul>
<p>のいずれも満たすことがわかる。</p>
<p>同じことが有理数にも言える。自然数の場合には負を扱うことができないので、一旦整数を経由して定義することになる。</p>
<p>ところでほとんどのプログラミング言語で扱えるプリミティブ型は (<code>Float</code> だとか <code>Double</code> だとかも含めて) 有理数に変換できるので有理数を経由することでだいたいなんでも距離順序にできる。</p>
<p><em>実際コンピュータは機械語やアセンブリのレベルでは整数の差をもって大小関係を判定しているのでありこれは自然な事実であろう。そのとき単なる符号だけでなくその絶対値も考えることで直積のような 2 次元の順序を考える場合に都合がよいということである。</em></p>
<p>また整数や有理数の場合、さらに強い性質</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)+f(y,z)=f(x,z)</annotation></semantics></math></li>
</ul>
<p>も満たすこともわかる。このような性質をもつ距離順序を考えると都合がいいのでこれを<strong>線型距離順序</strong> と呼ぼう。</p>
<p>さてありとあらゆる全順序関係は</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mn>1</mn><mo accent="false">⇔</mo><mi>x</mi><mo>&lt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x,y)=-1 \Leftrightarrow x&lt;y</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn><mo accent="false">⇔</mo><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x,y)=0 \Leftrightarrow x=y</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>1</mn><mo accent="false">⇔</mo><mi>x</mi><mo>&gt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">f(x,y)=1 \Leftrightarrow x&gt;y</annotation></semantics></math></li>
</ul>
<p>と置くことでその順序を整数に写す写像を定義でき、距離順序となる。</p>
<h2 id="マンハッタン距離順序と積順序">マンハッタン距離順序と積順序</h2>
<p>さてマンハッタン距離について考えよう。マンハッタン距離とは点 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">p = (x, y)</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">q = (x&#39;, y&#39;)</annotation></semantics></math> が与えられたとき <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">d((x,y),(x&#39;,y&#39;))=|x-x&#39;|+|y-y&#39;|</annotation></semantics></math> と定義される距離である。これは距離空間をなす。</p>
<p>さてそのうえで符号を許容するようにマンハッタン距離順序を考えたい。マンハッタン距離（というか格子状の座標系）は 45 度回転させる操作が簡単で</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g((x,y),(x&#39;,y&#39;))=((x-x&#39;)+(y-y&#39;), (x-x&#39;)-(y-y&#39;))</annotation></semantics></math></li>
</ul>
<p>と定義できる。これは点 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x&#39;,y&#39;)</annotation></semantics></math> の相対座標を 45 度回転させた相対座標を得ることができる。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>+</mo><annotation encoding="application/x-tex">+</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math> を入れ替えれば回転する方向を変えることができる。</p>
<p>一般に垂直もしくは水平に移動するとマンハッタン距離は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> ずつ増減するのに対し対角線の方向に移動するとマンハッタン距離は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math> ずつ増減するため、格子状の座標系では垂直もしくは水平に配置されたものを対角線に配置すると、ぞのマンハッタン距離は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math> 倍になる。</p>
<p>この回転させた点を <strong>辞書式順序</strong> で並べることで自然な全順序関係を得ることができる。距離を考えない場合にはそれでもいいものの、あくまで距離順序とするのであれば、距離の概念もあわせて考えておこう。そのようにすることで距離順序の距離順序というような概念も考えることができて都合がいいからである。</p>
<p>さて <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math> の定義のうち</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g((x,y),(x&#39;,y&#39;))=((x-x&#39;)+(y-y&#39;), (x-x&#39;)-(y-y&#39;))</annotation></semantics></math></li>
</ul>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>−</mo><mi>x</mi><mo>′</mo></mrow><annotation encoding="application/x-tex">x-x&#39;</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>−</mo><mi>y</mi><mo>′</mo></mrow><annotation encoding="application/x-tex">y-y&#39;</annotation></semantics></math> という部分は距離順序であり、これは任意の距離順序に一般化し</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g((x,y),(x&#39;,y&#39;))=(f(x,x&#39;)+f(y,y&#39;), f(x,x&#39;)-f(y,y&#39;))</annotation></semantics></math></li>
</ul>
<p>と置き換えてしまおう。そこで</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mo stretchy="false" form="postfix">)</mo><mo accent="false">⇔</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>∧</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)=sgn(x)(|x|+|y|) \Leftrightarrow (x,y)=g(p,q) \land sgn(x)\neq{}0</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mo stretchy="false" form="postfix">)</mo><mo accent="false">⇔</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>∧</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)=sgn(y)(|x|+|y|) \Leftrightarrow (x,y)=g(p,q) \land sgn(x)=0</annotation></semantics></math></li>
</ul>
<p>と定義し、これが距離順序の公理を満たすことを証明しよう。</p>
<p>なおここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">sgn(x)</annotation></semantics></math> ではなく <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">sgn(y)</annotation></semantics></math> を優先する定義も考えられその場合には対角線の確度の向きが変わる。それは <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mrow></mrow><mi>x</mi><mo>′</mo><mo>∧</mo><mrow></mrow><mi>y</mi><mo>≥</mo><mrow></mrow><mi>y</mi><mo>′</mo></mrow><annotation encoding="application/x-tex">x\leq{}x&#39;\land{}y\geq{}y&#39;</annotation></semantics></math> のように順序が反変する関係のものを優先して並べるようになるのでこれを別の定義と捉える場合には<strong>共変マンハッタン距離順序</strong> や <strong>反変マンハッタン距離順序</strong> と呼ぼう。</p>
<p>ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">p=(x,y)</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">q=(x&#39;,y&#39;)</annotation></semantics></math> や <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo accent="false">″</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">r=(x&#39;&#39;,y&#39;&#39;)</annotation></semantics></math> と表すことにする。</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p=q\Leftrightarrow{}f(p,q)=0</annotation></semantics></math></p>
<p><strong>証明</strong></p>
<ul>
<li>まず <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p=q\Rightarrow{}f(p,q)=0</annotation></semantics></math> を証明する。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,x&#39;)=0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(y,y&#39;)=0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g(p,q)=0</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)=0</annotation></semantics></math></li>
<li>次に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi><mo accent="false">⇐</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p=q\Leftarrow{}f(p,q)=0</annotation></semantics></math> を証明する。
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(x)\neq{}0</annotation></semantics></math> の場合。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">|x|+|y|\neq{}0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\neq{}0</annotation></semantics></math> であるから前提と矛盾する。</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(x)=0</annotation></semantics></math> の場合。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(y)\neq{}0</annotation></semantics></math> と仮定すれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">|x|+|y|\neq{}0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\neq{}0</annotation></semantics></math> であるから前提と矛盾する。よって <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(y)=0</annotation></semantics></math> であり、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(x)=0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn(y)=0</annotation></semantics></math> なので <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,q)=(0,0)</annotation></semantics></math> である。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math> の定義を見れば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mi>t</mi><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">fst(g(p,q))=0</annotation></semantics></math> となるのはある <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> が存在して <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(x,x&#39;)=k</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(y,y&#39;)=-k</annotation></semantics></math> となる場合のみであり、さらに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>n</mi><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">snd(g(p,q))=0</annotation></semantics></math> となるのはそれと同じ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> について <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(x,x&#39;)=k</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(y,y&#39;)=k</annotation></semantics></math> となる場合のみであるとわかる。ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(y,y&#39;)=-k</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f(y,y&#39;)=k</annotation></semantics></math> となる <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> のみであるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k=0</annotation></semantics></math> である。よって <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>x</mi><mo>′</mo><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=x&#39;\Leftrightarrow{}f(x,x&#39;)=0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>y</mi><mo>′</mo><mo accent="false">⇔</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=y&#39;\Leftrightarrow{}f(y,y&#39;)=0</annotation></semantics></math> であり <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p=q</annotation></semantics></math> ∎</li>
</ul></li>
</ul>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(p,q)=-f(q,p)</annotation></semantics></math></p>
<p><strong>証明</strong> まず <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>p</mi><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">(x,y)=p,(x&#39;,y&#39;)=q</annotation></semantics></math> と置く。公理より <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x&#39;,x)=-f(x,x&#39;)</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(y&#39;,y)=-f(y,y&#39;)</annotation></semantics></math> であるから</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,q)=(f(x,x&#39;)+f(y,y&#39;),f(x,x&#39;)-f(y,y&#39;))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(q,p)=(f(x&#39;,x)+f(y&#39;,y),f(x&#39;,x)-f(y&#39;,y))=((-f(x,x&#39;))+(-f(y,y&#39;)),(-f(x,x&#39;))-(-f(y,y&#39;)))</annotation></semantics></math></li>
</ul>
<p>である。式を整理すれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(q,p)=(-(f(x,x&#39;)+f(y,y&#39;)),-(f(x,x&#39;)-f(y,y&#39;)))</annotation></semantics></math> となる。</p>
<p>ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,q)=(f(x,x&#39;)+f(y,y&#39;),f(x,x&#39;)-f(y,y&#39;))</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_1)=g(p,q),(x_2,y_2)=g(q,p)</annotation></semantics></math> と置けば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_1=-x_2</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_1=-y_2</annotation></semantics></math> とわかる。さてここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> の定義を見れば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(p,q)|=|x_1|+|y_1|=|x_2|+|y_2|=|f(q,p)|</annotation></semantics></math> であり、その絶対値は等しい。そして <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">sgn(x_1)=-sgn(x_2)</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">sgn(y_1)=-sgn(y_2)</annotation></semantics></math> であるから符号もちょうど反転した関係にある。また符号が反転しても場合分けでの定義は変わらない。よって <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(p,q)=-f(q,p)</annotation></semantics></math> ∎</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(p,q)|+|f(q,r)|\geq{}|f(p,r)|</annotation></semantics></math></p>
<p><strong>証明</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_1)=g(p,q)</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_2,y_2)=g(q,r)</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_3,y_3)=g(p,r)</annotation></semantics></math> と置くと <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(p,q)|=|x_1|+|y_1|</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(q,r)|=|x_2|+|y_2|</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>3</mn></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(p,r)|=|x_3|+|y_3|</annotation></semantics></math> と表せる。ここで <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_1=f(x,x&#39;)+f(y,y&#39;)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_2=f(x&#39;,x&#39;&#39;)+f(y&#39;,y&#39;&#39;)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_3=f(x,x&#39;&#39;)+f(y,y&#39;&#39;)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_1=f(x,x&#39;)-f(y,y&#39;)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_2=f(x&#39;,x&#39;&#39;)-f(y&#39;,y&#39;&#39;)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_3=f(x,x&#39;&#39;)-f(y,y&#39;&#39;)</annotation></semantics></math> であって、絶対値の大小関係を示すには単に 2 乗すればよい。すなわち</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>1</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|x_1|^2+|y_1|^2=(f(x,x&#39;)+f(y,y&#39;))^2+(f(x,x&#39;)-f(y,y&#39;))^2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>2</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|x_2|^2+|y_2|^2=(f(x&#39;,x&#39;&#39;)+f(y&#39;,y&#39;&#39;))^2+(f(x&#39;,x&#39;&#39;)-f(y&#39;,y&#39;&#39;))^2</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>3</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>3</mn></msub><msup><mo stretchy="false" form="prefix">|</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|x_3|^2+|y_3|^2=(f(x,x&#39;&#39;)+f(y,y&#39;&#39;))^2+(f(x,x&#39;&#39;)-f(y,y&#39;&#39;))^2</annotation></semantics></math></li>
</ul>
<p>の大小関係さえ調べればよい。</p>
<p>このうち <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(x,x&#39;)|+|f(x&#39;,x&#39;&#39;)|\geq{}|f(x,x&#39;&#39;)|</annotation></semantics></math> および <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(y,y&#39;)|+|f(y&#39;,y&#39;&#39;)|\geq{}|f(y,y&#39;&#39;)|</annotation></semantics></math> は距離順序の公理より成り立ち、これはその和や差や累乗のみからなる式であるからやはり大小関係はなりたつ。従って <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>3</mn></msub><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|x_1|+|y_1|+|x_2|+|y_2|\geq{}|x_3|+|y_3|</annotation></semantics></math> である。ゆえに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>+</mo><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo><mo>≥</mo><mrow></mrow><mo stretchy="false" form="prefix">|</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">|f(p,q)|+|f(q,r)|\geq{}|f(p,r)|</annotation></semantics></math> ∎</p>
<p>さて次に <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\geq{}0\land{}f(q,r)\geq{}0\Rightarrow{}f(p,r)\geq{}0</annotation></semantics></math> という命題について考えてみよう。</p>
<p><strong>命題</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\geq{}0\land{}f(q,r)\geq{}0\Rightarrow{}f(p,r)\geq{}0</annotation></semantics></math></p>
<p>これがが成り立つためには符号が反転しない必要がある。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math> の定義のうち</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,q)=g((x,y),(x&#39;,y&#39;))=(f(x,x&#39;)+f(y,y&#39;), f(x,x&#39;)-f(y,y&#39;))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo accent="false">″</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(q,r)=g((x&#39;,y&#39;),(x&#39;&#39;,y&#39;&#39;))=(f(x&#39;,x&#39;&#39;)+f(y&#39;,y&#39;&#39;), f(x&#39;,x&#39;&#39;)-f(y&#39;,y&#39;&#39;))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo accent="false">″</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,r)=g((x,y),(x&#39;&#39;,y&#39;&#39;))=(f(x,x&#39;&#39;)+f(y,y&#39;&#39;), f(x,x&#39;&#39;)-f(y,y&#39;&#39;))</annotation></semantics></math></li>
</ul>
<p>という部分に着目すると、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> の増加量が異なるとグラフにしたときにある点を境に符号が反転してしまうことがわかる。距離順序の公理には増加量に関する定義がないため、一般にこの命題は成り立たない。そこで距離順序をもうすこし強めた公理系が必要である。</p>
<p>もし整数のような性質をもつ距離順序の場合にはこの性質が成り立つことが容易に確かめられる。そこで今回は</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(x,x&#39;)+f(x&#39;,x&#39;&#39;)=f(x,x&#39;&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">f(y,y&#39;)+f(y&#39;,y&#39;&#39;)=f(y,y&#39;&#39;)</annotation></semantics></math></li>
</ul>
<p>を仮定したい。</p>
<p><strong>定理</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo>∧</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn><mo accent="false">⇒</mo><mrow></mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\geq{}0\land{}f(q,r)\geq{}0\Rightarrow{}f(p,r)\geq{}0</annotation></semantics></math></p>
<p><strong>証明</strong></p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,q)=g((x,y),(x&#39;,y&#39;))=(f(x,x&#39;)+f(y,y&#39;), f(x,x&#39;)-f(y,y&#39;))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo accent="false">″</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(q,r)=g((x&#39;,y&#39;),(x&#39;&#39;,y&#39;&#39;))=(f(x&#39;,x&#39;&#39;)+f(y&#39;,y&#39;&#39;), f(x&#39;,x&#39;&#39;)-f(y&#39;,y&#39;&#39;))</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo accent="false">″</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g(p,r)=g((x,y),(x&#39;&#39;,y&#39;&#39;))=(f(x,x&#39;&#39;)+f(y,y&#39;&#39;), f(x,x&#39;&#39;)-f(y,y&#39;&#39;))</annotation></semantics></math></li>
</ul>
<p>であり、その符号は</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_1=f(x,x&#39;)+f(y,y&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_1=f(x,x&#39;)-f(y,y&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_2=f(x&#39;,x&#39;&#39;)+f(y&#39;,y&#39;&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_2=f(x&#39;,x&#39;&#39;)-f(y&#39;,y&#39;&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">x_3=f(x,x&#39;&#39;)+f(y,y&#39;&#39;)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo accent="false">″</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">y_3=f(x,x&#39;&#39;)-f(y,y&#39;&#39;)</annotation></semantics></math></li>
</ul>
<p>によって与えられる。仮定より <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\geq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(q,r)\geq{}0</annotation></semantics></math> である。このとき、とくに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1\geq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2\geq{}0</annotation></semantics></math> である。さて <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_3=x_1+x_2</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_3\geq{}0</annotation></semantics></math> である。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_3&gt;0</annotation></semantics></math> であればよい。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_3=0</annotation></semantics></math> の場合 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1=0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2=0</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y_1\geq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y_2\geq{}0</annotation></semantics></math> である。さてこの場合でも <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_3=y_1+y_2</annotation></semantics></math> であるから <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">y_3\geq{}0</annotation></semantics></math> である。ゆえに <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false" form="postfix">)</mo><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">f(p,q)\geq{}0</annotation></semantics></math> ∎</p>
<p>この証明では等式であるためその和が常に 0 よりも大きいことは簡単に確かめられた。一方で不等式の場合、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1\geq{}0</annotation></semantics></math> かつ <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2\geq{}0</annotation></semantics></math> を仮定しても <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_3\geq{}0</annotation></semantics></math> を言うのは簡単なことではない。もし <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1\geq{}0</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2\geq{}0</annotation></semantics></math> とが負と正の数の和でもって表されていてたまたま合計で正になっている場合、三角不等式では増加量に関する性質をなにも言えないため、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>≥</mo><mrow></mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">x_3\geq{}0</annotation></semantics></math> が正になるか負になるかはまったくでたらめになってしまう。ただもしもそれぞれの距離順序がなんらかの単位でその増加量が制限されていたならば、その増加量がいくら変化しても正負が反転しないことが証明できるかもしれない。</p>
<p>さてこのように定めた順序関係は通常の積順序の <strong>線型順序拡大</strong> になっている。つまり積順序で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)\leq{}(x&#39;,y&#39;)</annotation></semantics></math> ならば (共変) マンハッタン距離順序でも <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>′</mo><mo>,</mo><mi>y</mi><mo>′</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)\leq{}(x&#39;,y&#39;)</annotation></semantics></math> である。</p>
<p>ところで <strong>辞書式順序</strong> と呼ばれる直積の順序を距離順序で定めるためには右の要素数が有限であってその数を知ることができるか、もしくは <strong>無限の距離</strong> というものを考える必要がある。一方で対角線の長さでの順序は、要素数を知らずとも定義できるという性質がある。</p>
<p>またマンハッタン距離におけるおもしろい性質として積順序で <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">A\times{}B</annotation></semantics></math> が稠密でない高々可算の集合であって</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>≤</mo><mrow></mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><msub><mo>′</mo><mi>n</mi></msub><mo>,</mo><mi>y</mi><msub><mo>′</mo><mi>m</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_1)\leq{}(x&#39;_n,y&#39;_m)</annotation></semantics></math> であって <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><msub><mo>′</mo><mi>n</mi></msub><mo>,</mo><mi>y</mi><msub><mo>′</mo><mi>m</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d((x_1,y_1),(x&#39;_n,y&#39;_m))=n+m-1</annotation></semantics></math></p>
<p>のとき</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>&lt;</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>&lt;</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><msub><mo>′</mo><mi>n</mi></msub><mo>,</mo><mi>y</mi><msub><mo>′</mo><mi>m</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_1)&lt;(x_1,y_2)&lt;(x_2,y_2)&lt;\cdots&lt;(x&#39;_n,y&#39;_m)</annotation></semantics></math></p>
<p>と推移律をたどって隙間なく並べたとき、</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo>⋯</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><msub><mo>′</mo><mi>n</mi></msub><mo>,</mo><mi>y</mi><msub><mo>′</mo><mi>m</mi></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">G=\{(x_1,y_1),(x_1,y_2),(x_2,y_2),\cdots,(x&#39;_n,y&#39;_m)\}</annotation></semantics></math></p>
<p>という有限集合を考えると <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi>G</mi><mo stretchy="false" form="prefix">|</mo><mo>=</mo><mi>n</mi><mo>+</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">|G|=n+m</annotation></semantics></math> となる。つまり積順序が全順序となるよう比較可能なものをできるだけたくさん集めた <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>⊆</mo><mrow></mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">G\subseteq{}A\times{}B</annotation></semantics></math> という部分集合において <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math> の距離関数がその区間の元の個数を表すとき、マンハッタン距離は積順序が全順序となりうる <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mrow></mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">A\times{}B</annotation></semantics></math> の部分集合の元の個数の最大値から <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> をひいた数に等しい。</p>
<h2 id="実装と形式化および今後の展望">実装と形式化、および今後の展望</h2>
<p>まだ途中ではあるもののこの直観に基づいて二分木を定義できないかいろいろと模索している。実際に動く Haskell 実装と Coq による形式化が現在 <a href="../../misc/lemma">Lemma</a> にある。このように定義した二分木は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math> の組が与えられた場合には通常の二分木と同様の性能を発揮し、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> か <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> かのいずれか一方が与えられた場合には、 75% の要素に関しては <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(log_2(n))</annotation></semantics></math> で探索できるものの、 25% の外れ値 (存在しない場合も含む) の最悪計算量は <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math> となる。ただし外れ値が存在しないことが判定できれば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">O(log_2(n))</annotation></semantics></math> で探索が可能であり、そのために距離の概念を使うことができる。具体的にはたとえば <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>≤</mo><mi>y</mi><mo>≤</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_1 \leq y \leq y_2</annotation></semantics></math> となるような範囲を指定したり、あるいは最大限と最小限を記録しておくことで高速な探索が可能になる。</p>
<p>基本的なアイディアは順序関係を最適化することでうまく直積を二分探索できないかというものなので、データ構造としてはマンハッタン距離順序を順序関係とする赤黒木など、ありとあらゆる二分木や二分探索などのデータ構造やアルゴリズムに応用できる。</p>
<p>また目下最大の問題は複数の距離順序間の増加量が一致しない場合に順序がまったくでたらめになってしまうことであり、実装としては一応は動くものの、理論的な性質があまりよくない。この問題に関してはベクトル空間における <strong>基底</strong> の概念を追加すればよいのではないかと考えている。つまり問題の根本は複数の座標系における基底変換をするための情報が与えられていないことによるのではないか、というのはまだ直観の段階ではあるものの。<em>「すべての道は線型代数に通ずる」ンッン～名言だなこれは。</em></p>
<p>また三角不等式は上から抑えることができないので (理論的な) 問題が起きているとも言える。実装としてはまあ問題ないことも多い。実際マンハッタン距離順序の場合でも無制限に距離が伸びるのではなく、実際には高々 2 倍（だよね？）の距離に収まる。これを考えると 1 次元においては高々 1 倍の距離に収まり 2 次元においては高々 2 倍の距離に収まりという類推は効く。もちろんまだ直観の段階なのでなんの準備もできていない。</p>
<p>また直積だけでなく直和の距離順序についても検討中ではあるものの、これについてはまだわたしのなかでは答えが出ていない。実装として <code>Either a b</code> を <code>Metric</code> の instance にはしてあるものの、この定義でいいのかまったく自信がないのである。もちろん全順序にはなっていてプログラムとして問題なく動作はする。とはいえその性質に関してわたしはまだなにもわかっていない。たとえばこのように定義した <code>Either a b</code> を要素とするような直積のマンハッタン距離順序は仮定が異なっているためいまのところ、わたしにもまったく動作が予測できない。ひょっとしたらうまく動作するのかもしれないし、ぜんぜんでたらめな動作をするかもしれない。このようなマンハッタン距離順序の動作は (いまのところ) まったく不定である。</p>
</article>
