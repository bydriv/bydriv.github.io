<!DOCTYPE html><!--

--><head prefix="og: http://ogp.me/ns#"><!--

--><meta property="og:url" content="https://bydriv.github.io" /><!--
--><meta property="og:type" content="article" /><!--
--><meta property="og:title" content="bydriv.github.io" /><!--
--><meta property="og:description" content="personal website" /><!--
--><meta property="og:site_name" content="bydriv.github.io" /><!--
--><meta name="twitter:card" content="summary"><!--

--><meta charset="utf-8"><!--
--><meta name="viewport" content="width=device-width, initial-scale=1"><!--
--><title>bydriv.github.io</title><!--

--><link rel="stylesheet" type="text/css" href="/prelude/style.css"><!--

--></head><!--

--><div class="taskbar"><!--
--><a class="icon" href="/">&#x221A;</a><!--
--><a class="icon" href="/about">&#x1F4BD;</a><!--
--><a class="icon" href="/gallery">&#x1F3A8;</a><!--
--><a class="icon" href="/agent-log">&#x1F4BB;</a><!--
--><a class="icon" href="/agent-log-underground">&#x1F495;</a><!--
--><a class="icon" href="/blog">&#x1F4DD;</a><!--
--><a class="icon" href="/anne">&#x1F45A;</a><!--
--></div>
<div class="window">
  <div class="header"></div>
  <div class="content">
<h2 >Anne 開発日記 (2019-04-19)
</h2>
<h3 >エラーメッセージがまともになった
</h3>
<p>よい開発者はエラー処理に気を遣う（ほんまか）。
</p>
<p>いままでエラーメッセージはただ単に SyntaxError としか表示していなかった。
それを行番号など表示するようにした。
</p>
<p>たとえばこういうふうに書くと:
</p>
<pre >#pre &lt;&lt;FOO
BAR
</pre>
<p>こんなふうに表示される:
</p>
<pre >$ anne &lt; a.anne
1:6-2:4: error: nonterminating raw text
#pre &lt;&lt;FOO
BAR
</pre>
<p>このブログではまだハイライトを実装していないので地味だが、ターミナルでは色もつくし下線もひかれる。
</p>
<h3 >周辺ツールをすこし開発した
</h3>
<p>Anne は Shirley などのライブラリでいろいろな方言
(DSLと言ってもよいかもしれない)
が定義できるシリアライズフォーマットとして設計されている。
</p>
<p>このような設計にするメリットは方言に依らずに処理できる周辺ツールを充実させることができることだと思う (ほんまか)。
</p>
<p>というわけで、 Anne の周辺ツールを試しにいくつか開発している。
</p>
<h4 >enna
</h4>
<p><a href=https://github.com/bydriv/bydriv.github.io/blob/master/anne/bin/enna>https://github.com/bydriv/bydriv.github.io/blob/master/anne/bin/enna</a>
</p>
<p>enna は anne が出力した JSON を Anne に戻すツールである。
</p>
<pre >$ anne &lt; a.anne | enna &gt; b.anne
# a.anne と b.anne はまったく同じ
$ diff a.anne b.anne
$ echo $?
0
</pre>
<h4 >annegrep
</h4>
<p><a href=https://github.com/bydriv/bydriv.github.io/blob/master/anne/bin/annegrep>https://github.com/bydriv/bydriv.github.io/blob/master/anne/bin/annegrep</a>
</p>
<p>annegrep は段落単位、コードブロック単位で Anne を検索する。
</p>
<pre >$ cat &lt;&lt; EOF &gt; a.anne
段落1: aaaaaaaaaaaaaaaa
段落1: bbbbbbbbbbbbbbbb
段落1: cccccccccccccccc

段落2: dddddddddddddddd
段落2: eeeeeeeeeeeeeeee
段落2: ffffffffffffffff
EOF
$ anne &lt; a.anne | annegrep -p b | enna
段落1: aaaaaaaaaaaaaaaa
段落1: bbbbbbbbbbbbbbbb
段落1: cccccccccccccccc
</pre>
  </div>
</div>
